#!/usr/bin/env bash
# Update and install necessary tools
apt-get update
apt-get install -y net-tools nginx

# Nginx configuration file
NGINX_CONF="/etc/nginx/sites-available/default"

# Update Nginx configuration to listen on port 80
sed -i 's/listen 80 default_server;/listen 80;/g' $NGINX_CONF

# Restart Nginx
service nginx restart

# Check if Nginx is listening on port 80
if ! ss -tulpn | grep -q ':80'; then
    echo "Nginx is not listening on port 80. Please check the configuration."
    exit 1
fi

echo "Nginx is now configured to listen on port 80 for all active IPv4 IPs."

