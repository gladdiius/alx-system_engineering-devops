#!/usr/bin/env bash
# Get the hostname of the server
hostname=$(hostname)

# Check if Nginx is already installed
if [ -x "$(command -v nginx)" ]; then
    echo "Nginx is already installed."
else
    # Install Nginx
    sudo apt-get update
    sudo apt-get install -y nginx
fi

# Nginx configuration file path
nginx_conf="/etc/nginx/sites-available/custom-header"

# Add custom header to Nginx configuration
echo "server {
    listen 80;
    server_name localhost; # Change this to your server name or IP address

    location / {
        # Your existing location configuration goes here

        # Add custom header
        add_header X-Served-By $hostname;
    }

    # Additional server blocks or configurations can be added here
}" | sudo tee "$nginx_conf" > /dev/null

# Create a symbolic link to enable the site
sudo ln -s "$nginx_conf" "/etc/nginx/sites-enabled/"

# Test Nginx configuration
sudo nginx -t

# Reload Nginx to apply changes
sudo systemctl reload nginx

